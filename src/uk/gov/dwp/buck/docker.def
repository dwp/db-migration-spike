def docker(
    name,
    app_home,
    cmd,
    lib  = [],
    docker_file = 'Dockerfile'):
    cmd = [
        '$(exe //src/uk/gov/dwp/buck:create_dockerfile)',
        '--cmd', "'%s'" % cmd,
        '--out', '$OUT',
        '--home', app_home,
        '--tmp', '$TMP']
    for l in lib:
        cmd.extend(['--lib ', '$(classpath %s)' % l])
    genrule(
       name = name,
       bash = ' '.join(cmd),
       out  = docker_file,
    )

def docker_build(
    name,
    docker_file,
    tag,
    version = 'latest'):
    cmd = [
        '$(exe //src/uk/gov/dwp/buck:build_docker_image)',
        '-f', docker_file,
        '-t %s:%s' % (tag, version),
        '--out', '$OUT',
        '--tmp', '$TMP'
    ]
    genrule(
        name = name,
        bash = ' '.join(cmd),
        out = 'docker-build.sh',
        executable = True

    )
